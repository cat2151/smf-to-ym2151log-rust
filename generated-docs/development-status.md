Last updated: 2026-01-21

# Development Status

## 現在のIssues
-   [Issue #47](../issue-notes/47.md) では、SMFバイナリをJSONに変換する機能をブラウザ対応させるため、Rustとwasm-bindgenを用いてWASMインターフェースを実装中です。
-   [Issue #33](../issue-notes/33.md) は、`ym2151-tone-editor`が出力するGM000 variations format JSONを、従来の`tones/`ディレクトリの音色データより優先して読み込む新しい仕様の追加を検討しています。
-   [Issue #22](../issue-notes/22.md) は、`ym2151-tone-editor`を利用して`tones/000.json`から`127.json`までの音色ファイルを実際に作成し、配置するという手作業のタスクです。

## 次の一手候補
1.  [Issue #47](../issue-notes/47.md) WASMビルドとSMFパースロジックのライブラリ化状況の確認
    -   最初の小さな一歩: `Cargo.toml`と`src/lib.rs`を調査し、WASMビルドに必要な設定が適切か、またSMFパースロジック（`src/midi/parser.rs`）がライブラリクレートとして分離しやすい構造になっているか現状を確認する。
    -   Agent実行プロンプト:
        ```
        対象ファイル: `Cargo.toml`, `src/lib.rs`, `src/midi/parser.rs`

        実行内容: 対象ファイルについて、以下の観点から分析し、現状を報告してください。
        1. WASMビルドに必要な設定 (`[lib]`セクションの`crate-type = ["cdylib"]`など) が`Cargo.toml`に存在するか。
        2. `src/lib.rs`で`wasm-bindgen`が利用されているか、またエントリポイントとなる関数が定義されているか。
        3. `src/midi/parser.rs`にあるSMFパースロジックが、ライブラリクレートとして分離しやすい、あるいは既に分離されている構造になっているか。

        確認事項: WASMビルド設定と既存のCLI機能との競合がないか、また`src/midi/`モジュールの依存関係を確認してください。

        期待する出力: 上記の分析結果をmarkdown形式で出力してください。特に、SMFパースロジックの分離に関する具体的な提案や、WASMエントリポイントの実装に必要な変更点を明確にしてください。
        ```

2.  [Issue #33](../issue-notes/33.md) 外部トーン定義読み込みの設計準備
    -   最初の小さな一歩: `src/ym2151/tone.rs`と`src/ym2151/init.rs`を分析し、現在のトーンデータ読み込みパスを特定する。`ym2151-tone-editor`が出力するJSONを読み込むための新しいパス（例えばコマンドライン引数や環境変数で指定されるディレクトリ）をどこに追加すべきか検討する。
    -   Agent実行プロンプト:
        ```
        対象ファイル: `src/ym2151/tone.rs`, `src/ym2151/init.rs`, `src/main.rs`

        実行内容: 対象ファイルについて、現在のYM2151トーンデータ（`tones/`ディレクトリ）の読み込みロジックを詳細に分析してください。特に、以下の点を明確にしてください。
        1. トーンデータがどのようにロードされ、アプリケーション内で利用されているか。
        2. 外部から指定されたディレクトリ（例:`ym2151-tone-editor`の出力先）からトーンデータを読み込む機能を追加する際、既存のロジックにどのような変更が必要か。
        3. 既存の`tones/`ディレクトリのデータと外部データの優先順位をどのように管理すべきか（例: 外部データがあれば優先、なければ既存データを使用）。

        確認事項: `tones/`ディレクトリの読み込みロジックと、`src/main.rs`での初期化処理の依存関係を確認してください。ファイルシステムアクセスに関するRustの標準ライブラリの使用方法も考慮してください。

        期待する出力: 外部トーン定義を読み込むための設計案をmarkdown形式で出力してください。具体的には、変更が必要な関数やモジュール、優先順位付けのロジック、および新しいディレクトリパスを指定するための方法（CLIオプション、環境変数など）に関する提案を含めてください。
        ```

3.  [Issue #22](../issue-notes/22.md) ym2151-tone-editor出力JSONと既存トーン定義の比較分析
    -   最初の小さな一歩: プロジェクト内の既存トーン定義ファイル`tones/000.json`の内容を分析し、`ym2151-tone-editor`が生成するJSON形式（仮定として、GitHubリポジトリ等で公開されている情報を参照）と比較する。両者の互換性や、変換が必要な要素があるかを確認する。
    -   Agent実行プロンプト:
        ```
        対象ファイル: `tones/000.json` (プロジェクト内の既存ファイル)

        実行内容: `tones/000.json`の構造と内容を分析し、一般的な`ym2151-tone-editor`が出力するであろうJSONフォーマット（もし参照可能な情報があれば、それを元に）との互換性を評価してください。以下の点に焦点を当ててください。
        1. 両者のJSONスキーマ（主要なキー、値の型、ネスト構造など）の類似点と相違点。
        2. 既存のYM2151レジスタ設定イベントの表現方法の違い。
        3. もし互換性がない場合、どのような変換ロジックが必要になるか。

        確認事項: `ym2151-tone-editor`の出力フォーマットに関する公開情報やドキュメントがあれば、それを参照し、分析の精度を高めてください。また、本プロジェクトの`src/ym2151/tone.rs`でのJSONパースロジックも考慮に入れてください。

        期待する出力: `tones/000.json`と`ym2151-tone-editor`出力JSONフォーマットの比較結果をmarkdown形式で出力してください。互換性の評価、具体的な相違点、およびもし変換が必要な場合の変換方針について記述してください。

---
Generated at: 2026-01-21 07:09:40 JST

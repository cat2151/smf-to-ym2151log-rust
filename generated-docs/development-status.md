Last updated: 2025-11-26

# Development Status

## 現在のIssues
- [Issue #33](../issue-notes/33.md) は、`ym2151-tone-editor`が出力する音色JSONを、従来の`tones/`ディレクトリよりも優先して読み込む新しい仕様追加を検討しています。
- この新仕様の検証は、`ym2151-tone-editor`の出力ディレクトリをシンボリックリンクで接続することを仮定しており、Rustコード側のパス解決ロジックに影響があります。
- [Issue #22](../issue-notes/22.md) では、`ym2151-tone-editor`を利用して`tones/000.json`から`127.json`を実際に作成・配置する手作業が必要とされています。

## 次の一手候補
1. [Issue #33](../issue-notes/33.md) ym2151-tone-editor出力JSON優先読み込みの検証環境準備
   - 最初の小さな一歩: `ym2151-tone-editor`の出力パスと既存音色データ読み込みロジックの調査、およびRustにおけるシンボリックリンクの取り扱いを確認する。
   - Agent実行プロンプト:
     ```
     対象ファイル: src/ym2151/tone.rs, src/lib.rs

     実行内容: `src/ym2151/tone.rs`内の音色データ読み込みロジックを詳細に分析し、`ym2151-tone-editor`の出力ファイル（仮に`../ym2151-tone-editor/generated_tones/`に配置されると想定）を優先的にロードするためのファイルパス解決アプローチを調査してください。具体的には、Rustの`std::fs`モジュールがシンボリックリンクをどう処理するか、および複数のパスからファイルを検索するパターンを調査し、コード変更の方向性を検討してください。

     確認事項: 現在の音色ファイル（`tones/*.json`）の読み込みが`src/ym2151/tone.rs`内のどの関数で行われているか、およびそのファイルパス解決の仕組み。Rustにおける`Path`や`PathBuf`、`fs::canonicalize`などの関数がシンボリックリンクに対してどう振る舞うか。

     期待する出力: 調査結果をMarkdown形式で出力してください。これには、現在の音色読み込み関数と、新しい音源パス（symlink含む）を解決するための具体的なRustのAPI利用案、および考えられる実装パターンが含まれるようにしてください。
     ```

2. [Issue #22](../issue-notes/22.md) ym2151-tone-editorを用いた音色データ作成手順の整理
   - 最初の小さな一歩: 既存の`tones/000.json`の構造を分析し、`ym2151-tone-editor`を用いて同形式のJSONファイルを生成するためのステップをまとめる。
   - Agent実行プロンプト:
     ```
     対象ファイル: tones/000.json, issue-notes/22.md

     実行内容: `tones/000.json`のJSONスキーマ（特に`events`配列内のオブジェクト構造）を詳細に分析し、このフォーマットに合致するYM2151音色データを作成するために外部ツールである`ym2151-tone-editor`をどのように利用すべきか、具体的な手順をステップバイステップでMarkdown形式で整理してください。ツールの操作方法（例：パラメータ設定、エクスポート機能）に焦点を当ててください。

     確認事項: `tones/000.json`の`events`配列内の各オブジェクトが持つキー（`time`, `addr`, `data`）とその値の型。`ym2151-tone-editor`が一般的にどのような出力フォーマットに対応しているか（特定のツール情報が提供されていないため、標準的なYM2151音色エディタの機能と仮定して推測）。

     期待する出力: `ym2151-tone-editor`を利用して`tones/000.json`のような音色JSONファイルを生成するための、以下の要素を含む詳細な手順書をMarkdown形式で出力してください：ツールの起動と設定、音色の編集方法、エクスポート手順、注意点。
     ```

3. 音色データ読み込みロジックの柔軟性向上とリファクタリングの検討
   - 最初の小さな一歩: 既存の音色データ読み込みロジックが、複数のパスや優先順位を持つソースからの読み込みにどう対応できるかを分析し、改善点を洗い出す。
   - Agent実行プロンプト:
     ```
     対象ファイル: src/ym2151/tone.rs, src/ym2151/mod.rs, src/lib.rs

     実行内容: `src/ym2151/tone.rs`内の音色データ読み込みロジック（`tones/`ディレクトリからの読み込み）を詳細に分析し、将来的に複数の音源パス（例：`tones/`ディレクトリと`ym2151-tone-editor`の出力ディレクトリ）からの読み込みをサポートするための、より柔軟な構造へのリファクタリング案を検討してください。具体的には、音色ソースの抽象化（例：`ToneSource`トレイトの導入）や、複数のパスを順次試すための検索ロジックの導入、エラーハンドリングの改善など、設計パターンを考慮した提案を行ってください。

     確認事項: 現在の音色読み込み関数がどのような構造を持ち、どの範囲のファイルパスを扱っているか。音色データがどのようにアプリケーション全体に渡されているか。RustにおけるDI (Dependency Injection) やトレイトを用いた抽象化の一般的なパターン。

     期待する出力: 現在の音色読み込みロジックの課題点、および将来的な拡張性（複数ソース対応）を考慮したリファクタリングの提案をMarkdown形式で出力してください。これには、新しいモジュール構造、トレイト定義のアイデア、ファイルI/Oとエラー処理の改善案が含まれるようにしてください。
     ```

---
Generated at: 2025-11-26 07:07:50 JST
